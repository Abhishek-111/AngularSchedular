<div class="container mt-2">

  <div>
    <!-- whole calendar here... -->
    <div class="row text-center">
      <div class="col-md-4">
        <div class="btn-group">
          <div class="btn btn-primary" mwlCalendarPreviousView [view]="view" [(viewDate)]="viewDate" (viewDateChange)="closeOpenMonthViewDay()">
            <span class="material-symbols-outlined">arrow_back_ios</span>
          </div>
          <div class="btn btn-outline-secondary" mwlCalendarToday [(viewDate)]="viewDate">
            Today
          </div>
          <div class="btn btn-primary" mwlCalendarNextView [view]="view" [(viewDate)]="viewDate" (viewDateChange)="closeOpenMonthViewDay()">
            <span class="material-symbols-outlined">arrow_forward_ios</span>
          </div>
        </div>
      </div>
      <div class="col-md-4 mt-3">
        <h3>
          {{ viewDate | calendarDate:(view + 'ViewTitle'):'en' }}
        </h3>
      </div>

      <div class="col-md-4">
        <div class="btn-group">
          <div class="btn btn-primary" (click)="setView(CalendarView.Month)" [class.active]="view === CalendarView.Month">
            Month
          </div>
          <div class="btn btn-primary" (click)="setView(CalendarView.Week)" [class.active]="view === CalendarView.Week">
            Week
          </div>
          <div class="btn btn-primary" (click)="setView(CalendarView.Day)" [class.active]="view === CalendarView.Day">
            Day
          </div>
        </div>
      </div>


    </div>



    <div [ngSwitch]="view" class="mt-3 mb-4">
      <mwl-calendar-month-view *ngSwitchCase="CalendarView.Month" [viewDate]="viewDate" [events]="eventService.events" [refresh]="refresh" [activeDayIsOpen]="activeDayIsOpen" (dayClicked)="dayClicked($event.day)" (eventClicked)="handleEvent('Clicked', $event.event)" (eventTimesChanged)="eventTimesChanged($event)"
      [activeDay]="jumpToDate">
      <ng-template #defaultCellTemplate let-day="day">
        <div [ngClass]="{'custom-active-day':isJumpToDate(day)}">
          {{day.date | date:'d'}}
        </div>
      </ng-template>
      
      </mwl-calendar-month-view>

      <mwl-calendar-week-view *ngSwitchCase="CalendarView.Week" [viewDate]="viewDate" [events]="eventService.events" [refresh]="refresh" (eventClicked)="handleEvent('Clicked', $event.event)" (eventTimesChanged)="eventTimesChanged($event)">
      </mwl-calendar-week-view>
      <mwl-calendar-day-view *ngSwitchCase="CalendarView.Day" [viewDate]="viewDate" [events]="eventService.events" [refresh]="refresh" (eventClicked)="handleEvent('Clicked', $event.event)" (eventTimesChanged)="eventTimesChanged($event)">
      </mwl-calendar-day-view>
    </div>
  </div>
  </div>


   <!-- Modal for update and delete event -->
   <div class="modal" id="myModal3" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">

        <div class="modal-body">
          <div class="px-2 py-2">
            <h5 class="text-uppercase">Event</h5>
          </div><hr class="dotted-line">
          <div class="mb-3">
            
          </div>

          <div class="d-flex justify-content-between">
            <span class="font-weight-bold">Title</span>
            <span><input type="text" class="form-control mb-2" [(ngModel)]="selectedEvent.title" (keyup)="refresh.next()" placeholder="Event Title"></span>
          </div>

          <div class="d-flex justify-content-between">
            <span class="font-weight-bold">Starts At</span>
            <span><input class="form-control mb-2" type="text" mwlFlatpickr [(ngModel)]="selectedEvent.start" (ngModelChange)="refresh.next()" [altInput]="true" [convertModelValue]="true" [enableTime]="true" dateFormat="Y-m-dTH:i" altFormat="F j, Y H:i" placeholder="Not set" /></span>
          </div>

          <div class="d-flex justify-content-between">
            <span class="font-weight-bold">Ends At</span>
            <span><input class="form-control mb-2" type="text" mwlFlatpickr [(ngModel)]="selectedEvent.end" (ngModelChange)="refresh.next()" [altInput]="true" [convertModelValue]="true" [enableTime]="true" dateFormat="Y-m-dTH:i" altFormat="F j, Y H:i" placeholder="Not set" /></span>
          </div>

          <div class="d-flex justify-content-between">
            <span class="font-weight-bold">Comment</span>
            <span><input type="text" class="form-control mb-2" [(ngModel)]="selectedEvent.comment" (keyup)="refresh.next()" placeholder="Any Comment"></span>
          </div>

          <hr class="dotted-line">
          <div class="btn">
            <button type="button" class="btn btn-outline-danger ml-2" (click)="deleteEvent()"><span class="material-symbols-outlined">delete</span>Delete</button>
            <button type="button" class="btn btn-outline-primary ml-2" (click)="updateEvent()"><span class="material-symbols-outlined">update</span>Update</button>
            <button type="button" class="btn btn-outline-secondary" data-dismiss="modal" (click)="closeModal()"><span class="material-symbols-outlined">close</span>Close</button>
          </div>
          
        </div>
        
      </div>

    </div>
  </div>


  <!-- Modal to display events list of a selected day -->
  <div class="modal" id="myModal2" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">

        <div class="modal-body">
          <div class="px-2 py-2">
            <h5 class="text-uppercase">Events on  {{dateOfEvent}}</h5>
          </div><hr class="dotted-line">

          <div *ngFor="let event of eventsOfSelectedDate">
            <div class="d-flex justify-content-between">
            
                  <button class="btn btn-outline-primary" (click)="targetEvent(event.id)">{{event.title}}</button>
            </div>
          </div>

          <hr class="dotted-line">
          <div class="btn">
            <button type="button" class="btn btn-outline-secondary" data-dismiss="modal" (click)="closeModalOfEvents()"><span class="material-symbols-outlined">close</span>Close</button>
          </div>
          
        </div>
        
      </div>

    </div>
  </div>
  